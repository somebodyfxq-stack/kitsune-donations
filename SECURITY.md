# üîê –ë–µ–∑–ø–µ–∫–∞ —Ç–æ–∫–µ–Ω—ñ–≤ Monobank

## –û–≥–ª—è–¥

–¢–æ–∫–µ–Ω–∏ Monobank —Ç–µ–ø–µ—Ä —à–∏—Ñ—Ä—É—é—Ç—å—Å—è –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏.

## –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

### –ê–ª–≥–æ—Ä–∏—Ç–º
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: AES-256-GCM
- **IV**: 12 –±–∞–π—Ç (–≤–∏–ø–∞–¥–∫–æ–≤–∏–π –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞)
- **Auth Tag**: 16 –±–∞–π—Ç (–¥–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó)
- **AAD**: "monobank-token" (–¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ)

### –§–æ—Ä–º–∞—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
```
IV:AuthTag:EncryptedData
```
–î–µ –≤—Å—ñ —á–∞—Å—Ç–∏–Ω–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —è–∫ hex strings.

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### 1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

```bash
# –ì–µ–Ω–µ—Ä—É—î–º–æ 32-–±–∞–π—Ç–Ω–∏–π –∫–ª—é—á (64 hex —Å–∏–º–≤–æ–ª–∏)
openssl rand -hex 32
```

### 2. –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞ –¥–æ .env

```env
ENCRYPTION_KEY=–≤–∞—à_64_—Å–∏–º–≤–æ–ª—å–Ω–∏–π_hex_–∫–ª—é—á_—Ç—É—Ç
```

### 3. –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤

```bash
npm run encrypt-tokens
```

## –ë–µ–∑–ø–µ–∫–∞

### ‚úÖ –©–æ –∑–∞—Ö–∏—â–µ–Ω–æ
- –¢–æ–∫–µ–Ω–∏ –≤ –ë–î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ
- –ö–æ–∂–µ–Ω —Ç–æ–∫–µ–Ω –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π IV
- Auth tag –∑–∞—Ö–∏—â–∞—î –≤—ñ–¥ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- AAD –¥–æ–¥–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç

### ‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ
- **–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ ENCRYPTION_KEY –≤ –±–µ–∑–ø–µ—Ü—ñ**
- **–ù–µ –∫–æ–º—ñ—Ç—å—Ç–µ .env —Ñ–∞–π–ª**
- **–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç—É–π—Ç–µ –∫–ª—é—á—ñ**
- **Backup –∫–ª—é—á—ñ–≤ –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ**

### üîÑ –†–æ—Ç–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤

1. –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –Ω–æ–≤–∏–π –∫–ª—é—á
2. –†–æ–∑—à–∏—Ñ—Ä—É–π—Ç–µ –≤—Å—ñ —Ç–æ–∫–µ–Ω–∏ —Å—Ç–∞—Ä–∏–º –∫–ª—é—á–µ–º
3. –ó–∞—à–∏—Ñ—Ä—É–π—Ç–µ –Ω–æ–≤–∏–º –∫–ª—é—á–µ–º
4. –û–Ω–æ–≤—ñ—Ç—å ENCRYPTION_KEY

## –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å

- ‚úÖ **GDPR**: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ –∑–∞—Ö–∏—â–µ–Ω—ñ
- ‚úÖ **PCI DSS**: –¢–æ–∫–µ–Ω–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ
- ‚úÖ **ISO 27001**: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–π –∑–∞—Ö–∏—Å—Ç

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–º–∏–ª–∫–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:
```bash
grep "Failed to decrypt token" logs/
```

