# Kitsune Donations v1.3

## Основні можливості

- **Персоналізовані OBS віджети**: кожен стрімер має свій унікальний віджет `/obs/{username}`
- **Шифрування токенів**: всі Monobank токени зберігаються в зашифрованому вигляді в БД
- **Фільтрація донатів**: кожен віджет показує тільки донати для конкретного користувача
- **SSE з heartbeat** кожні 15с, щоб не засинав конекшн
- **TTS озвучення** донатів через Google Text-to-Speech

## OBS віджети

### Безпечні персоналізовані віджети
- `/obs/{унікальний_токен}` - віджет для конкретного стрімера з унікальним хешем
- Кожен користувач має свій секретний токен для віджета
- Токен автоматично генерується при першому підключенні банки

### Параметри віджета
- `?voice=назва_голосу` - вибір голосу для TTS озвучення

### Як отримати URL віджета
1. Увійдіть в панель адміністратора `/panel`
2. Підключіть Monobank банку
3. Скопіюйте URL віджета з розділу "OBS Browser Source URL"

### Використання в OBS
1. Додайте Browser Source в OBS
2. Вставте скопійований URL
3. Розмір: 1920x1080
4. Увімкніть "Shutdown source when not visible"

## Безпека

### Шифрування токенів Monobank
Токени шифруються за допомогою AES-256-CBC перед збереженням в БД.

**Налаштування:**
1. Додайте в `.env` файл:
```env
ENCRYPTION_KEY=ваш_64_символьний_hex_ключ
```

2. Для генерації ключа:
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

3. Зашифруйте існуючі токени:
```bash
npm run encrypt-tokens
```

## Запуск

```bash
pnpm i && cp .env.example .env.local && pnpm dev
```

**Важливо**: Для реального вебхука потрібен публічний HTTPS. За бажанням встановіть `MONOBANK_WEBHOOK_SECRET` для перевірки підпису `X-Sign`.
